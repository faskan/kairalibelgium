(self.webpackChunkapp_src=self.webpackChunkapp_src||[]).push([[7290,7585],{7585:(A,v,p)=>{function R(n,u,e,t,i,s,o){try{var r=n[s](o),a=r.value}catch(c){return void e(c)}r.done?u(a):Promise.resolve(a).then(t,i)}function g(n){return function(){var u=this,e=arguments;return new Promise(function(t,i){var s=n.apply(u,e);function o(a){R(s,t,i,o,r,"next",a)}function r(a){R(s,t,i,o,r,"throw",a)}o(void 0)})}}p.r(v),p.d(v,{AmazonLoginProvider:()=>D,BaseLoginProvider:()=>d,DummyLoginProvider:()=>w,FacebookLoginProvider:()=>P,GoogleLoginProvider:()=>_,GoogleSigninButtonDirective:()=>U,GoogleSigninButtonModule:()=>b,MicrosoftLoginProvider:()=>L,SocialAuthService:()=>O,SocialLoginModule:()=>y,SocialUser:()=>h,VKLoginProvider:()=>N});var l=p(5760),m=p(3635),f=p(5893),T=p(4888);class d{constructor(){}loadScript(u,e,t,i=null){if(typeof document<"u"&&!document.getElementById(u)){let s=document.createElement("script");s.async=!0,s.src=e,s.onload=t,i||(i=document.head),i.appendChild(s)}}}class h{}const k={oneTapEnabled:!0};let _=(()=>{class n extends d{constructor(e,t){super(),this.clientId=e,this.initOptions=t,this.changeUser=new l.EventEmitter,this._socialUser=new m.BehaviorSubject(null),this._accessToken=new m.BehaviorSubject(null),this._receivedAccessToken=new l.EventEmitter,this.initOptions={...k,...this.initOptions},this._socialUser.pipe((0,f.skip)(1)).subscribe(this.changeUser),this._accessToken.pipe((0,f.skip)(1)).subscribe(this._receivedAccessToken)}initialize(e){return new Promise((t,i)=>{try{this.loadScript(n.PROVIDER_ID,"https://accounts.google.com/gsi/client",()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:e,callback:({credential:s})=>{const o=this.createSocialUser(s);this._socialUser.next(o)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe((0,f.filter)(s=>null===s)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){const s=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(o=>o).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:s,prompt:this.initOptions.prompt,callback:o=>{o.error?this._accessToken.error({code:o.error,description:o.error_description,uri:o.error_uri}):this._accessToken.next(o.access_token)}})}t()})}catch(s){i(s)}})}getLoginStatus(){return new Promise((e,t)=>{this._socialUser.value?e(this._socialUser.value):t(`No user is currently logged in with ${n.PROVIDER_ID}`)})}refreshToken(){return new Promise((e,t)=>{google.accounts.id.revoke(this._socialUser.value.id,i=>{i.error?t(i.error):e(this._socialUser.value)})})}getAccessToken(){return new Promise((e,t)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe((0,f.take)(1)).subscribe(e)):t(this._socialUser.value?"No token client was instantiated, you should specify some scopes.":"You should be logged-in first.")})}revokeAccessToken(){return new Promise((e,t)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),e()}):t("No access token to revoke"):t("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){var e=this;return g(function*(){google.accounts.id.disableAutoSelect(),e._socialUser.next(null)})()}createSocialUser(e){const t=new h;t.idToken=e;const i=this.decodeJwt(e);return t.id=i.sub,t.name=i.name,t.email=i.email,t.photoUrl=i.picture,t.firstName=i.given_name,t.lastName=i.family_name,t}decodeJwt(e){const i=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(window.atob(i).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(s)}}return n.PROVIDER_ID="GOOGLE",n})(),O=(()=>{class n{get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(e,t,i){this._ngZone=t,this._injector=i,this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new m.ReplaySubject(1),this.initialized=!1,this._initState=new m.AsyncSubject,e instanceof Promise?e.then(s=>{this.initialize(s)}):this.initialize(e)}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(i=>{this.providers.set(i.id,"prototype"in i.provider?this._injector.get(i.provider):i.provider)}),Promise.all(Array.from(this.providers.values()).map(i=>i.initialize(this.autoLogin))).then(()=>{if(this.autoLogin){const i=[];let s=!1;this.providers.forEach((o,r)=>{const a=o.getLoginStatus();i.push(a),a.then(c=>{this.setUser(c,r),s=!0}).catch(console.debug)}),Promise.all(i).catch(()=>{s||(this._user=null,this._authState.next(null))})}this.providers.forEach((i,s)=>{(0,m.isObservable)(i.changeUser)&&i.changeUser.subscribe(o=>{this._ngZone.run(()=>{this.setUser(o,s)})})})}).catch(i=>{t(i)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(e){var t=this;return g(function*(){const i=t.providers.get(e);if(!t.initialized)throw n.ERR_NOT_INITIALIZED;if(!i)throw n.ERR_LOGIN_PROVIDER_NOT_FOUND;if(!(i instanceof _))throw n.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN;return yield i.getAccessToken()})()}refreshAuthToken(e){return new Promise((t,i)=>{if(this.initialized){const s=this.providers.get(e);s?"function"!=typeof s.refreshToken?i(n.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):s.refreshToken().then(o=>{this.setUser(o,e),t()}).catch(o=>{i(o)}):i(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(n.ERR_NOT_INITIALIZED)})}refreshAccessToken(e){return new Promise((t,i)=>{if(this.initialized)if(e!==_.PROVIDER_ID)i(n.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const s=this.providers.get(e);s instanceof _?s.revokeAccessToken().then(t).catch(i):i(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(n.ERR_NOT_INITIALIZED)})}signIn(e,t){return new Promise((i,s)=>{if(this.initialized){let o=this.providers.get(e);o?o.signIn(t).then(r=>{this.setUser(r,e),i(r)}).catch(r=>{s(r)}):s(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(n.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((t,i)=>{if(this.initialized)if(this._user){let o=this.providers.get(this._user.provider);o?o.signOut(e).then(()=>{t(),this.setUser(null)}).catch(r=>{i(r)}):i(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(n.ERR_NOT_LOGGED_IN);else i(n.ERR_NOT_INITIALIZED)})}setUser(e,t){e&&t&&(e.provider=t),this._user=e,this._authState.next(e)}}return n.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",n.ERR_NOT_LOGGED_IN="Not logged in",n.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",n.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",n.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token",n.\u0275fac=function(e){return new(e||n)(l.\u0275\u0275inject("SocialAuthServiceConfig"),l.\u0275\u0275inject(l.NgZone),l.\u0275\u0275inject(l.Injector))},n.\u0275prov=l.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),y=(()=>{class n{static initialize(e){return{ngModule:n,providers:[O,{provide:"SocialAuthServiceConfig",useValue:e}]}}constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}}return n.\u0275fac=function(e){return new(e||n)(l.\u0275\u0275inject(n,12))},n.\u0275mod=l.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=l.\u0275\u0275defineInjector({providers:[O],imports:[T.CommonModule]}),n})(),w=(()=>{class n extends d{constructor(e){super(),this.dummy=e||n.DEFAULT_USER,this.loggedIn=!1}getLoginStatus(){return new Promise((e,t)=>{this.loggedIn?e(this.dummy):t("No user is currently logged in.")})}initialize(){return new Promise((e,t)=>{e()})}signIn(){return new Promise((e,t)=>{this.loggedIn=!0,e(this.dummy)})}signOut(e){return new Promise((t,i)=>{this.loggedIn=!1,t()})}}return n.PROVIDER_ID="DUMMY",n.DEFAULT_USER={id:"1234567890",name:"Mickey Mouse",email:"mickey@mouse.com",firstName:"Mickey",lastName:"Mouse",authToken:"dummyAuthToken",photoUrl:"https://en.wikipedia.org/wiki/File:Mickey_Mouse.png",provider:"DUMMY",idToken:"dummyIdToken",authorizationCode:"dummyAuthCode",response:{}},n})(),P=(()=>{class n extends d{constructor(e,t={}){super(),this.clientId=e,this.requestOptions={scope:"email,public_profile",locale:"en_US",fields:"name,email,picture,first_name,last_name",version:"v10.0"},this.requestOptions={...this.requestOptions,...t}}initialize(){return new Promise((e,t)=>{try{this.loadScript(n.PROVIDER_ID,`//connect.facebook.net/${this.requestOptions.locale}/sdk.js`,()=>{FB.init({appId:this.clientId,autoLogAppEvents:!0,cookie:!0,xfbml:!0,version:this.requestOptions.version}),e()})}catch(i){t(i)}})}getLoginStatus(){return new Promise((e,t)=>{FB.getLoginStatus(i=>{if("connected"===i.status){let s=i.authResponse;FB.api(`/me?fields=${this.requestOptions.fields}`,o=>{let r=new h;r.id=o.id,r.name=o.name,r.email=o.email,r.photoUrl="https://graph.facebook.com/"+o.id+"/picture?type=normal&access_token="+s.accessToken,r.firstName=o.first_name,r.lastName=o.last_name,r.authToken=s.accessToken,r.response=o,e(r)})}else t(`No user is currently logged in with ${n.PROVIDER_ID}`)})})}signIn(e){const t={...this.requestOptions,...e};return new Promise((i,s)=>{FB.login(o=>{if(o.authResponse){let r=o.authResponse;FB.api(`/me?fields=${t.fields}`,a=>{let c=new h;c.id=a.id,c.name=a.name,c.email=a.email,c.photoUrl="https://graph.facebook.com/"+a.id+"/picture?type=normal",c.firstName=a.first_name,c.lastName=a.last_name,c.authToken=r.accessToken,c.response=a,i(c)})}else s("User cancelled login or did not fully authorize.")},t)})}signOut(){return new Promise((e,t)=>{FB.logout(i=>{e()})})}}return n.PROVIDER_ID="FACEBOOK",n})(),D=(()=>{class n extends d{constructor(e,t={scope:"profile",scope_data:{profile:{essential:!1}},redirect_uri:location.origin}){super(),this.clientId=e,this.initOptions=t}initialize(){let e=null;return document&&(e=document.createElement("div"),e.id="amazon-root",document.body.appendChild(e)),window.onAmazonLoginReady=()=>{amazon.Login.setClientId(this.clientId)},new Promise((t,i)=>{try{this.loadScript("amazon-login-sdk","https://assets.loginwithamazon.com/sdk/na/login1.js",()=>{t()},e)}catch(s){i(s)}})}getLoginStatus(){return new Promise((e,t)=>{let i=this.retrieveToken();i?amazon.Login.retrieveProfile(i,s=>{if(s.success){let o=new h;o.id=s.profile.CustomerId,o.name=s.profile.Name,o.email=s.profile.PrimaryEmail,o.response=s.profile,e(o)}else t(s.error)}):t(`No user is currently logged in with ${n.PROVIDER_ID}`)})}signIn(e){const t={...this.initOptions,...e};return new Promise((i,s)=>{amazon.Login.authorize(t,o=>{o.error?s(o.error):amazon.Login.retrieveProfile(o.access_token,r=>{let a=new h;a.id=r.profile.CustomerId,a.name=r.profile.Name,a.email=r.profile.PrimaryEmail,a.authToken=o.access_token,a.response=r.profile,this.persistToken(o.access_token),i(a)})})})}signOut(){return new Promise((e,t)=>{try{amazon.Login.logout(),this.clearToken(),e()}catch(i){t(i.message)}})}persistToken(e){localStorage.setItem(`${n.PROVIDER_ID}_token`,e)}retrieveToken(){return localStorage.getItem(`${n.PROVIDER_ID}_token`)}clearToken(){localStorage.removeItem(`${n.PROVIDER_ID}_token`)}}return n.PROVIDER_ID="AMAZON",n})();const E={notify:1,friends:2,photos:4,audio:8,video:16,offers:32,questions:64,pages:128,links:256,status:1024,notes:2048,messages:4096,wall:8192,ads:32768,offline:65536,docs:131072,groups:262144,notifications:524288,stats:1048576,email:4194304,market:134217728};let N=(()=>{class n extends d{constructor(e,t={fields:"photo_max,contacts",version:"5.131"}){super(),this.clientId=e,this.initOptions=t,this.VK_API_URL="//vk.com/js/api/openapi.js",this.VK_API_GET_USER="users.get"}initialize(){return new Promise((e,t)=>{try{this.loadScript(n.PROVIDER_ID,this.VK_API_URL,()=>{VK.init({apiId:this.clientId}),e()})}catch(i){t(i)}})}getLoginStatus(){return new Promise(e=>this.getLoginStatusInternal(e))}signIn(e){e?.includes("offers")&&console.warn('The "offers" permission is outdated.'),e?.includes("questions")&&console.warn('The "questions" permission is outdated.'),e?.includes("messages")&&console.warn('The "messages" permission is unavailable for non-standalone applications.');const t=e?.reduce((i,s)=>Object.keys(E).findIndex(r=>r===s)>-1?i+E[s]:0,0);return new Promise(i=>this.signInInternal(i,t))}signOut(){return new Promise(e=>{VK.Auth.logout(()=>{e()})})}signInInternal(e,t){VK.Auth.login(i=>{"connected"===i.status&&this.getUser(i.session.mid,i.session.sid,e)},t)}getUser(e,t,i){VK.Api.call(this.VK_API_GET_USER,{user_id:e,fields:this.initOptions.fields,v:this.initOptions.version},s=>{i(this.createUser(Object.assign({},{token:t},s.response[0])))})}getLoginStatusInternal(e){VK.Auth.getLoginStatus(t=>{"connected"===t.status&&this.getUser(t.session.mid,t.session.sid,e)})}createUser(e){const t=new h;return t.id=e.id,t.name=`${e.first_name} ${e.last_name}`,t.photoUrl=e.photo_max,t.authToken=e.token,t}}return n.PROVIDER_ID="VK",n})();var I=(()=>{return(n=I||(I={})).AAD="AAD",n.OIDC="OIDC",I;var n})();let L=(()=>{class n extends d{constructor(e,t){super(),this.clientId=e,this.initOptions={authority:"https://login.microsoftonline.com/common/",scopes:["openid","email","profile","User.Read"],knownAuthorities:[],protocolMode:I.AAD,clientCapabilities:[],cacheLocation:"sessionStorage"},this.initOptions={...this.initOptions,...t}}initialize(){return new Promise((e,t)=>{this.loadScript(n.PROVIDER_ID,"https://alcdn.msauth.net/browser/2.13.1/js/msal-browser.min.js",()=>{try{const i={auth:{clientId:this.clientId,redirectUri:this.initOptions.redirect_uri??location.origin,authority:this.initOptions.authority,knownAuthorities:this.initOptions.knownAuthorities,protocolMode:this.initOptions.protocolMode,clientCapabilities:this.initOptions.clientCapabilities},cache:this.initOptions.cacheLocation?{cacheLocation:this.initOptions.cacheLocation}:null};this._instance=new msal.PublicClientApplication(i),e()}catch(i){t(i)}})})}getSocialUser(e){return new Promise((t,i)=>{let s=new XMLHttpRequest;s.onreadystatechange=()=>{if(4==s.readyState)try{if(200==s.status){let o=JSON.parse(s.responseText),r=new h;r.provider=n.PROVIDER_ID,r.id=e.idToken,r.authToken=e.accessToken,r.name=e.idTokenClaims.name,r.email=e.account.username,r.idToken=e.idToken,r.response=e,r.firstName=o.givenName,r.lastName=o.surname,t(r)}else i(`Error retrieving user info: ${s.status}`)}catch(o){i(o)}},s.open("GET","https://graph.microsoft.com/v1.0/me"),s.setRequestHeader("Authorization",`Bearer ${e.accessToken}`);try{s.send()}catch(o){i(o)}})}getLoginStatus(){var e=this;return g(function*(){const t=e._instance.getAllAccounts();if(t?.length>0){const i=yield e._instance.ssoSilent({scopes:e.initOptions.scopes,loginHint:t[0].username});return yield e.getSocialUser(i)}throw`No user is currently logged in with ${n.PROVIDER_ID}`})()}signIn(){var e=this;return g(function*(){const t=yield e._instance.loginPopup({scopes:e.initOptions.scopes,prompt:e.initOptions.prompt});return yield e.getSocialUser(t)})()}signOut(e){var t=this;return g(function*(){const i=t._instance.getAllAccounts();i?.length>0&&(yield t._instance.logoutPopup({account:i[0],postLogoutRedirectUri:t.initOptions.logout_redirect_uri??t.initOptions.redirect_uri??location.href}))})()}}return n.PROVIDER_ID="MICROSOFT",n})(),U=(()=>{class n{constructor(e,t){this.type="icon",this.size="medium",this.text="signin_with",this.shape="rectangular",this.theme="outline",this.logo_alignment="left",this.width="",this.locale="",t.initState.pipe((0,f.take)(1)).subscribe(()=>{Promise.resolve(this.width).then(i=>{i>"400"||i<"200"&&""!=i?Promise.reject("Please note .. max-width 400 , min-width 200 (https://developers.google.com/identity/gsi/web/tools/configurator)"):google.accounts.id.renderButton(e.nativeElement,{type:this.type,size:this.size,text:this.text,width:this.width,shape:this.shape,theme:this.theme,logo_alignment:this.logo_alignment,locale:this.locale})})})}}return n.\u0275fac=function(e){return new(e||n)(l.\u0275\u0275directiveInject(l.ElementRef),l.\u0275\u0275directiveInject(O))},n.\u0275dir=l.\u0275\u0275defineDirective({type:n,selectors:[["asl-google-signin-button"]],inputs:{type:"type",size:"size",text:"text",shape:"shape",theme:"theme",logo_alignment:"logo_alignment",width:"width",locale:"locale"}}),n})(),b=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=l.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=l.\u0275\u0275defineInjector({}),n})()}}]);