(self.webpackChunkapp_src=self.webpackChunkapp_src||[]).push([[6290,1800],{1800:(D,v,g)=>{g.r(v),g.d(v,{AmazonLoginProvider:()=>w,BaseLoginProvider:()=>u,DummyLoginProvider:()=>P,FacebookLoginProvider:()=>y,GoogleLoginProvider:()=>d,GoogleSigninButtonDirective:()=>U,GoogleSigninButtonModule:()=>A,MicrosoftLoginProvider:()=>S,SocialAuthService:()=>p,SocialLoginModule:()=>O,SocialUser:()=>c,VKLoginProvider:()=>N});var f=g(5861),a=g(5760),m=g(3635),_=g(5893),E=g(4888);class u{constructor(){}loadScript(I,e,t,i=null){if(typeof document<"u"&&!document.getElementById(I)){let n=document.createElement("script");n.async=!0,n.src=e,n.onload=t,i||(i=document.head),i.appendChild(n)}}}class c{}const R={oneTapEnabled:!0};let d=(()=>{class s extends u{constructor(e,t){super(),this.clientId=e,this.initOptions=t,this.changeUser=new a.EventEmitter,this._socialUser=new m.BehaviorSubject(null),this._accessToken=new m.BehaviorSubject(null),this._receivedAccessToken=new a.EventEmitter,this.initOptions={...R,...this.initOptions},this._socialUser.pipe((0,_.skip)(1)).subscribe(this.changeUser),this._accessToken.pipe((0,_.skip)(1)).subscribe(this._receivedAccessToken)}initialize(e){return new Promise((t,i)=>{try{this.loadScript(s.PROVIDER_ID,"https://accounts.google.com/gsi/client",()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:e,callback:({credential:n})=>{const o=this.createSocialUser(n);this._socialUser.next(o)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe((0,_.filter)(n=>null===n)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){const n=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(o=>o).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:n,prompt:this.initOptions.prompt,callback:o=>{o.error?this._accessToken.error({code:o.error,description:o.error_description,uri:o.error_uri}):this._accessToken.next(o.access_token)}})}t()})}catch(n){i(n)}})}getLoginStatus(){return new Promise((e,t)=>{this._socialUser.value?e(this._socialUser.value):t(`No user is currently logged in with ${s.PROVIDER_ID}`)})}refreshToken(){return new Promise((e,t)=>{google.accounts.id.revoke(this._socialUser.value.id,i=>{i.error?t(i.error):e(this._socialUser.value)})})}getAccessToken(){return new Promise((e,t)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe((0,_.take)(1)).subscribe(e)):t(this._socialUser.value?"No token client was instantiated, you should specify some scopes.":"You should be logged-in first.")})}revokeAccessToken(){return new Promise((e,t)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),e()}):t("No access token to revoke"):t("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){var e=this;return(0,f.Z)(function*(){google.accounts.id.disableAutoSelect(),e._socialUser.next(null)})()}createSocialUser(e){const t=new c;t.idToken=e;const i=this.decodeJwt(e);return t.id=i.sub,t.name=i.name,t.email=i.email,t.photoUrl=i.picture,t.firstName=i.given_name,t.lastName=i.family_name,t}decodeJwt(e){const i=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(i).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)}}return s.PROVIDER_ID="GOOGLE",s})(),p=(()=>{class s{get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(e,t,i){this._ngZone=t,this._injector=i,this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new m.ReplaySubject(1),this.initialized=!1,this._initState=new m.AsyncSubject,e instanceof Promise?e.then(n=>{this.initialize(n)}):this.initialize(e)}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(i=>{this.providers.set(i.id,"prototype"in i.provider?this._injector.get(i.provider):i.provider)}),Promise.all(Array.from(this.providers.values()).map(i=>i.initialize(this.autoLogin))).then(()=>{if(this.autoLogin){const i=[];let n=!1;this.providers.forEach((o,r)=>{const l=o.getLoginStatus();i.push(l),l.then(h=>{this.setUser(h,r),n=!0}).catch(console.debug)}),Promise.all(i).catch(()=>{n||(this._user=null,this._authState.next(null))})}this.providers.forEach((i,n)=>{(0,m.isObservable)(i.changeUser)&&i.changeUser.subscribe(o=>{this._ngZone.run(()=>{this.setUser(o,n)})})})}).catch(i=>{t(i)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(e){var t=this;return(0,f.Z)(function*(){const i=t.providers.get(e);if(!t.initialized)throw s.ERR_NOT_INITIALIZED;if(!i)throw s.ERR_LOGIN_PROVIDER_NOT_FOUND;if(!(i instanceof d))throw s.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN;return yield i.getAccessToken()})()}refreshAuthToken(e){return new Promise((t,i)=>{if(this.initialized){const n=this.providers.get(e);n?"function"!=typeof n.refreshToken?i(s.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):n.refreshToken().then(o=>{this.setUser(o,e),t()}).catch(o=>{i(o)}):i(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(s.ERR_NOT_INITIALIZED)})}refreshAccessToken(e){return new Promise((t,i)=>{if(this.initialized)if(e!==d.PROVIDER_ID)i(s.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const n=this.providers.get(e);n instanceof d?n.revokeAccessToken().then(t).catch(i):i(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(s.ERR_NOT_INITIALIZED)})}signIn(e,t){return new Promise((i,n)=>{if(this.initialized){let o=this.providers.get(e);o?o.signIn(t).then(r=>{this.setUser(r,e),i(r)}).catch(r=>{n(r)}):n(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else n(s.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((t,i)=>{if(this.initialized)if(this._user){let o=this.providers.get(this._user.provider);o?o.signOut(e).then(()=>{t(),this.setUser(null)}).catch(r=>{i(r)}):i(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(s.ERR_NOT_LOGGED_IN);else i(s.ERR_NOT_INITIALIZED)})}setUser(e,t){e&&t&&(e.provider=t),this._user=e,this._authState.next(e)}}return s.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",s.ERR_NOT_LOGGED_IN="Not logged in",s.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",s.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",s.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token",s.\u0275fac=function(e){return new(e||s)(a.\u0275\u0275inject("SocialAuthServiceConfig"),a.\u0275\u0275inject(a.NgZone),a.\u0275\u0275inject(a.Injector))},s.\u0275prov=a.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),O=(()=>{class s{static initialize(e){return{ngModule:s,providers:[p,{provide:"SocialAuthServiceConfig",useValue:e}]}}constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}}return s.\u0275fac=function(e){return new(e||s)(a.\u0275\u0275inject(s,12))},s.\u0275mod=a.\u0275\u0275defineNgModule({type:s}),s.\u0275inj=a.\u0275\u0275defineInjector({providers:[p],imports:[E.CommonModule]}),s})(),P=(()=>{class s extends u{constructor(e){super(),this.dummy=e||s.DEFAULT_USER,this.loggedIn=!1}getLoginStatus(){return new Promise((e,t)=>{this.loggedIn?e(this.dummy):t("No user is currently logged in.")})}initialize(){return new Promise((e,t)=>{e()})}signIn(){return new Promise((e,t)=>{this.loggedIn=!0,e(this.dummy)})}signOut(e){return new Promise((t,i)=>{this.loggedIn=!1,t()})}}return s.PROVIDER_ID="DUMMY",s.DEFAULT_USER={id:"1234567890",name:"Mickey Mouse",email:"mickey@mouse.com",firstName:"Mickey",lastName:"Mouse",authToken:"dummyAuthToken",photoUrl:"https://en.wikipedia.org/wiki/File:Mickey_Mouse.png",provider:"DUMMY",idToken:"dummyIdToken",authorizationCode:"dummyAuthCode",response:{}},s})(),y=(()=>{class s extends u{constructor(e,t={}){super(),this.clientId=e,this.requestOptions={scope:"email,public_profile",locale:"en_US",fields:"name,email,picture,first_name,last_name",version:"v10.0"},this.requestOptions={...this.requestOptions,...t}}initialize(){return new Promise((e,t)=>{try{this.loadScript(s.PROVIDER_ID,`//connect.facebook.net/${this.requestOptions.locale}/sdk.js`,()=>{FB.init({appId:this.clientId,autoLogAppEvents:!0,cookie:!0,xfbml:!0,version:this.requestOptions.version}),e()})}catch(i){t(i)}})}getLoginStatus(){return new Promise((e,t)=>{FB.getLoginStatus(i=>{if("connected"===i.status){let n=i.authResponse;FB.api(`/me?fields=${this.requestOptions.fields}`,o=>{let r=new c;r.id=o.id,r.name=o.name,r.email=o.email,r.photoUrl="https://graph.facebook.com/"+o.id+"/picture?type=normal&access_token="+n.accessToken,r.firstName=o.first_name,r.lastName=o.last_name,r.authToken=n.accessToken,r.response=o,e(r)})}else t(`No user is currently logged in with ${s.PROVIDER_ID}`)})})}signIn(e){const t={...this.requestOptions,...e};return new Promise((i,n)=>{FB.login(o=>{if(o.authResponse){let r=o.authResponse;FB.api(`/me?fields=${t.fields}`,l=>{let h=new c;h.id=l.id,h.name=l.name,h.email=l.email,h.photoUrl="https://graph.facebook.com/"+l.id+"/picture?type=normal",h.firstName=l.first_name,h.lastName=l.last_name,h.authToken=r.accessToken,h.response=l,i(h)})}else n("User cancelled login or did not fully authorize.")},t)})}signOut(){return new Promise((e,t)=>{FB.logout(i=>{e()})})}}return s.PROVIDER_ID="FACEBOOK",s})(),w=(()=>{class s extends u{constructor(e,t={scope:"profile",scope_data:{profile:{essential:!1}},redirect_uri:location.origin}){super(),this.clientId=e,this.initOptions=t}initialize(){let e=null;return document&&(e=document.createElement("div"),e.id="amazon-root",document.body.appendChild(e)),window.onAmazonLoginReady=()=>{amazon.Login.setClientId(this.clientId)},new Promise((t,i)=>{try{this.loadScript("amazon-login-sdk","https://assets.loginwithamazon.com/sdk/na/login1.js",()=>{t()},e)}catch(n){i(n)}})}getLoginStatus(){return new Promise((e,t)=>{let i=this.retrieveToken();i?amazon.Login.retrieveProfile(i,n=>{if(n.success){let o=new c;o.id=n.profile.CustomerId,o.name=n.profile.Name,o.email=n.profile.PrimaryEmail,o.response=n.profile,e(o)}else t(n.error)}):t(`No user is currently logged in with ${s.PROVIDER_ID}`)})}signIn(e){const t={...this.initOptions,...e};return new Promise((i,n)=>{amazon.Login.authorize(t,o=>{o.error?n(o.error):amazon.Login.retrieveProfile(o.access_token,r=>{let l=new c;l.id=r.profile.CustomerId,l.name=r.profile.Name,l.email=r.profile.PrimaryEmail,l.authToken=o.access_token,l.response=r.profile,this.persistToken(o.access_token),i(l)})})})}signOut(){return new Promise((e,t)=>{try{amazon.Login.logout(),this.clearToken(),e()}catch(i){t(i.message)}})}persistToken(e){localStorage.setItem(`${s.PROVIDER_ID}_token`,e)}retrieveToken(){return localStorage.getItem(`${s.PROVIDER_ID}_token`)}clearToken(){localStorage.removeItem(`${s.PROVIDER_ID}_token`)}}return s.PROVIDER_ID="AMAZON",s})();const k={notify:1,friends:2,photos:4,audio:8,video:16,offers:32,questions:64,pages:128,links:256,status:1024,notes:2048,messages:4096,wall:8192,ads:32768,offline:65536,docs:131072,groups:262144,notifications:524288,stats:1048576,email:4194304,market:134217728};let N=(()=>{class s extends u{constructor(e,t={fields:"photo_max,contacts",version:"5.131"}){super(),this.clientId=e,this.initOptions=t,this.VK_API_URL="//vk.com/js/api/openapi.js",this.VK_API_GET_USER="users.get"}initialize(){return new Promise((e,t)=>{try{this.loadScript(s.PROVIDER_ID,this.VK_API_URL,()=>{VK.init({apiId:this.clientId}),e()})}catch(i){t(i)}})}getLoginStatus(){return new Promise(e=>this.getLoginStatusInternal(e))}signIn(e){e?.includes("offers")&&console.warn('The "offers" permission is outdated.'),e?.includes("questions")&&console.warn('The "questions" permission is outdated.'),e?.includes("messages")&&console.warn('The "messages" permission is unavailable for non-standalone applications.');const t=e?.reduce((i,n)=>Object.keys(k).findIndex(r=>r===n)>-1?i+k[n]:0,0);return new Promise(i=>this.signInInternal(i,t))}signOut(){return new Promise(e=>{VK.Auth.logout(()=>{e()})})}signInInternal(e,t){VK.Auth.login(i=>{"connected"===i.status&&this.getUser(i.session.mid,i.session.sid,e)},t)}getUser(e,t,i){VK.Api.call(this.VK_API_GET_USER,{user_id:e,fields:this.initOptions.fields,v:this.initOptions.version},n=>{i(this.createUser(Object.assign({},{token:t},n.response[0])))})}getLoginStatusInternal(e){VK.Auth.getLoginStatus(t=>{"connected"===t.status&&this.getUser(t.session.mid,t.session.sid,e)})}createUser(e){const t=new c;return t.id=e.id,t.name=`${e.first_name} ${e.last_name}`,t.photoUrl=e.photo_max,t.authToken=e.token,t}}return s.PROVIDER_ID="VK",s})();var T=(()=>{return(s=T||(T={})).AAD="AAD",s.OIDC="OIDC",T;var s})();let S=(()=>{class s extends u{constructor(e,t){super(),this.clientId=e,this.initOptions={authority:"https://login.microsoftonline.com/common/",scopes:["openid","email","profile","User.Read"],knownAuthorities:[],protocolMode:T.AAD,clientCapabilities:[],cacheLocation:"sessionStorage"},this.initOptions={...this.initOptions,...t}}initialize(){return new Promise((e,t)=>{this.loadScript(s.PROVIDER_ID,"https://alcdn.msauth.net/browser/2.13.1/js/msal-browser.min.js",()=>{try{const i={auth:{clientId:this.clientId,redirectUri:this.initOptions.redirect_uri??location.origin,authority:this.initOptions.authority,knownAuthorities:this.initOptions.knownAuthorities,protocolMode:this.initOptions.protocolMode,clientCapabilities:this.initOptions.clientCapabilities},cache:this.initOptions.cacheLocation?{cacheLocation:this.initOptions.cacheLocation}:null};this._instance=new msal.PublicClientApplication(i),e()}catch(i){t(i)}})})}getSocialUser(e){return new Promise((t,i)=>{let n=new XMLHttpRequest;n.onreadystatechange=()=>{if(4==n.readyState)try{if(200==n.status){let o=JSON.parse(n.responseText),r=new c;r.provider=s.PROVIDER_ID,r.id=e.idToken,r.authToken=e.accessToken,r.name=e.idTokenClaims.name,r.email=e.account.username,r.idToken=e.idToken,r.response=e,r.firstName=o.givenName,r.lastName=o.surname,t(r)}else i(`Error retrieving user info: ${n.status}`)}catch(o){i(o)}},n.open("GET","https://graph.microsoft.com/v1.0/me"),n.setRequestHeader("Authorization",`Bearer ${e.accessToken}`);try{n.send()}catch(o){i(o)}})}getLoginStatus(){var e=this;return(0,f.Z)(function*(){const t=e._instance.getAllAccounts();if(t?.length>0){const i=yield e._instance.ssoSilent({scopes:e.initOptions.scopes,loginHint:t[0].username});return yield e.getSocialUser(i)}throw`No user is currently logged in with ${s.PROVIDER_ID}`})()}signIn(){var e=this;return(0,f.Z)(function*(){const t=yield e._instance.loginPopup({scopes:e.initOptions.scopes,prompt:e.initOptions.prompt});return yield e.getSocialUser(t)})()}signOut(e){var t=this;return(0,f.Z)(function*(){const i=t._instance.getAllAccounts();i?.length>0&&(yield t._instance.logoutPopup({account:i[0],postLogoutRedirectUri:t.initOptions.logout_redirect_uri??t.initOptions.redirect_uri??location.href}))})()}}return s.PROVIDER_ID="MICROSOFT",s})(),U=(()=>{class s{constructor(e,t){this.type="icon",this.size="medium",this.text="signin_with",this.shape="rectangular",this.theme="outline",this.logo_alignment="left",this.width="",this.locale="",t.initState.pipe((0,_.take)(1)).subscribe(()=>{Promise.resolve(this.width).then(i=>{i>"400"||i<"200"&&""!=i?Promise.reject("Please note .. max-width 400 , min-width 200 (https://developers.google.com/identity/gsi/web/tools/configurator)"):google.accounts.id.renderButton(e.nativeElement,{type:this.type,size:this.size,text:this.text,width:this.width,shape:this.shape,theme:this.theme,logo_alignment:this.logo_alignment,locale:this.locale})})})}}return s.\u0275fac=function(e){return new(e||s)(a.\u0275\u0275directiveInject(a.ElementRef),a.\u0275\u0275directiveInject(p))},s.\u0275dir=a.\u0275\u0275defineDirective({type:s,selectors:[["asl-google-signin-button"]],inputs:{type:"type",size:"size",text:"text",shape:"shape",theme:"theme",logo_alignment:"logo_alignment",width:"width",locale:"locale"}}),s})(),A=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=a.\u0275\u0275defineNgModule({type:s}),s.\u0275inj=a.\u0275\u0275defineInjector({}),s})()},5861:(D,v,g)=>{function f(m,_,E,u,c,R,d){try{var p=m[R](d),O=p.value}catch(P){return void E(P)}p.done?_(O):Promise.resolve(O).then(u,c)}function a(m){return function(){var _=this,E=arguments;return new Promise(function(u,c){var R=m.apply(_,E);function d(O){f(R,u,c,d,p,"next",O)}function p(O){f(R,u,c,d,p,"throw",O)}d(void 0)})}}g.d(v,{Z:()=>a})}}]);